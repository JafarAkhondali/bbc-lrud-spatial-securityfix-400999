{"version":3,"file":"lrud.min.js","names":["focusableSelector","containerSelector","focusableContainerSelector","ignoredClass","matches","element","selectors","fn","Element","prototype","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","s","document","ownerDocument","querySelectorAll","i","length","item","call","toArray","nodeList","Array","slice","getParentContainer","elem","parentElement","tagName","getFocusables","scope","ignoredElements","className","indexOf","push","filter","node","some","ignored","contains","getAllFocusables","concat","container","_getFocusables","collectContainers","initialContainer","acc","cur","getMidpointForEdge","rect","dir","x","left","y","top","bottom","right","getNearestPoint","point","getDistanceBetweenPoints","a","b","Math","sqrt","pow","isBelow","isRight","getBlockedExitDirs","candidateContainer","currentAncestorContainers","candidateAncestorContainers","commonCandidate","spliceIndex","splice","reduce","dirs","getAttribute","split","isValidCandidate","entryRect","exitDir","exitPoint","entryWeighting","width","height","weightedEntryPoint","sortValidCandidates","candidates","exitRect","getBoundingClientRect","candidate","allowedOverlap","parseFloat","map","nearestPoint","distance","sort","_ref","getParentFocusableContainer","startingCandidate","getNextFocus","exports","keyOrKeyCode","_getFocusables2","querySelector","body","_keyMap","parentContainer","_getParentFocusableCo","setAttribute","id","focusableCandidates","focusableSiblings","_iterator","_createForOfIteratorHelper","_step","n","done","_getParentFocusableCo3","value","isBestCandidateAContainer","isCurrentContainer","isNestedContainer","isAnscestorContainer","blockedExitDirs","_getFocusables3","_getParentFocusableCo2","lastActiveChild","getElementById","newFocus","err","e","f","_left","_right","_up","_down"],"sources":["lrud.js"],"sourcesContent":["/**\n * LRUD: Spatial Edition\n *\n *  @@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@\n *  @@@@@@      '@@@@@@@@@   @@@@@@      '@@@@@@@@@   @@@@@@@@      '@@@@@@@\n *  @@@@@@  @@.   @@@@@@@@   @@@@@@  @@.    @@@@@@@   @@@@@     @@@@.   @@@@\n *  @@@@@@  @@@@  @@@@@@@@   @@@@@@  @@@@   @@@@@@@   @@@@   @@@@@@@@@@@@@@@\n *  @@@@@@        @@@@@@@@   @@@@@@        @@@@@@@@   @@@   @@@@@@@@@@@@@@@@\n *  @@@@@@  @@@@@.  @@@@@@   @@@@@@  @@@@@.  @@@@@@   @@@   @@@@@@@@@@@@@@@@\n *  @@@@@@  @@@@@   @@@@@@   @@@@@@  @@@@@   @@@@@@   @@@@    @@@@@@@@/ @@@@\n *  @@@@@@        /@@@@@@@   @@@@@@        /@@@@@@@   @@@@@@\\,         @@@@@\n *  @@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@\n *\n * Copyright (C) 2023 BBC.\n */\n\n// Any \"interactive content\" https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Content_categories#Interactive_content\nconst focusableSelector = '[tabindex], a, input, button';\nconst containerSelector = 'nav, section, .lrud-container';\nconst focusableContainerSelector = '[data-lrud-consider-container-distance]';\nconst ignoredClass = 'lrud-ignore';\n\n/**\n * Element API .matches() with fallbacks\n */\nconst matches = (element, selectors) => {\n  const fn = Element.prototype.matches ||\n    Element.prototype.matchesSelector ||\n    Element.prototype.mozMatchesSelector ||\n    Element.prototype.msMatchesSelector ||\n    Element.prototype.oMatchesSelector ||\n    Element.prototype.webkitMatchesSelector ||\n    function(s) {\n      var matches = (this.document || this.ownerDocument).querySelectorAll(s),\n        i = matches.length;\n      // eslint-disable-next-line no-empty\n      while (--i >= 0 && matches.item(i) !== this) {}\n      return i > -1;\n    };\n\n  return fn.call(element, selectors);\n};\n\n/**\n * Convert a NodeList to a regular Array\n *\n * @param {NodeList} nodeList The NodeList representation\n * @return {Array|null} The Array representation\n */\nconst toArray = (nodeList) => Array.prototype.slice.call(nodeList);\n\n/**\n * Traverse DOM ancestors until we find a focus container\n *\n * @param {HTMLElement} elem The element representing the search origin\n * @return {HTMLElement|null} The parent focus container or null\n */\nconst getParentContainer = (elem) => {\n  if (!elem.parentElement || elem.parentElement.tagName === 'BODY') {\n    return null;\n  } else if (matches(elem.parentElement, containerSelector)) {\n    return elem.parentElement;\n  }\n\n  return getParentContainer(elem.parentElement);\n};\n\n/**\n * Get all focusable elements inside `scope`,\n * discounting any that are ignored or inside an ignored container\n *\n * @param {HTMLElement} scope The element to search inside of\n * @return {HTMLElement[]} Array of valid focusables inside the scope\n */\nconst getFocusables = (scope) => {\n  if (!scope) return [];\n\n  const ignoredElements = toArray(scope.querySelectorAll('.' + ignoredClass));\n  if (scope.className.indexOf(ignoredClass) > -1) ignoredElements.push(scope);\n\n  return toArray(scope.querySelectorAll(focusableSelector))\n    .filter(node => !ignoredElements.some(ignored => ignored == node || ignored.contains(node)));\n};\n\n/**\n * Get all the focusable candidates inside `scope`,\n * including focusable containers\n *\n * @param {HTMLElement} scope The element to search inside of\n * @return {HTMLElement[]} Array of valid focusables inside the scope\n */\nconst getAllFocusables = (scope) => [\n  ...toArray(scope.querySelectorAll(focusableContainerSelector)).filter(container => getFocusables(container)?.length > 0),\n  ...getFocusables(scope)\n];\n\n/**\n * Build an array of ancestor containers\n *\n * @param {HTMLElement} initialContainer The container to start from\n * @return {HTMLElement[]} An array of ancestor containers\n */\nconst collectContainers = (initialContainer) => {\n  if (!initialContainer) return [];\n  const acc = [ initialContainer ];\n  let cur = initialContainer;\n  while (cur) {\n    cur = getParentContainer(cur);\n    if (cur) acc.push(cur);\n  }\n  return acc;\n};\n\n/**\n * Get the middle point of a given edge\n *\n * @param {Object} rect An object representing the rectangle\n * @param {String} dir The direction of the edge (left, right, up, down)\n * @return {Point} An object with the X and Y coordinates of the point\n */\nconst getMidpointForEdge = (rect, dir) => {\n  switch (dir) {\n    case 'left':\n      return { x: rect.left, y: (rect.top + rect.bottom) / 2 };\n    case 'right':\n      return { x: rect.right, y: (rect.top + rect.bottom) / 2 };\n    case 'up':\n      return { x: (rect.left + rect.right) / 2, y: rect.top };\n    case 'down':\n      return { x: (rect.left + rect.right) / 2, y: rect.bottom };\n  }\n};\n\n/**\n * Gets the nearest point on `rect` that a line in direction `dir` from `point` would hit\n * If the rect is exactly in direction `dir` then the point will be in a straight line from `point`.\n * Otherwise it will be the nearest corner of the target rect.\n *\n * @param {Point} point The point to start from\n * @param {String} dir The direction to draw the line in\n * @param {Object} rect An object representing the rectangle of the item we're going to\n * @return {Point} An object with the X/Y coordinates of the nearest point\n */\nconst getNearestPoint = (point, dir, rect) => {\n  if (dir === 'left' || dir === 'right') {\n    // When moving horizontally...\n    // The nearest X is always the nearest edge, left or right\n    const x = dir === 'left' ? rect.right : rect.left;\n\n    // If the start point is higher than the rect, nearest Y is the top corner\n    if (point.y < rect.top) return { x, y: rect.top };\n    // If the start point is lower than the rect, nearest Y is the bottom corner\n    if (point.y > rect.bottom) return { x, y: rect.bottom };\n    // Else the nearest Y is aligned with where we started\n    return { x, y: point.y };\n  } else if (dir === 'up' || dir === 'down') {\n    // When moving vertically...\n    // The nearest Y is always the nearest edge, top or bottom\n    const y = dir === 'up' ? rect.bottom : rect.top;\n\n    // If the start point is left-er than the rect, nearest X is the left corner\n    if (point.x < rect.left) return { x: rect.left, y };\n    // If the start point is right-er than the rect, nearest X is the right corner\n    if (point.x > rect.right) return { x: rect.right, y };\n    // Else the nearest X is aligned with where we started\n    return { x: point.x, y };\n  }\n};\n\n/**\n * Get the Pythagorean distance between two points\n *\n * @param {Point} a An object containing the X and Y coordinates of the point\n * @param {Point} b Point to compare\n * @return {number} Distance from A to B\n */\nconst getDistanceBetweenPoints = (a, b) => Math.sqrt(Math.pow(a.x - b.x, 2) + Math.pow(a.y - b.y, 2));\n\n/**\n * Check if point A is below point B\n *\n * @param {Point} a An object containing the X and Y coordinates of the point\n * @param {Point} b Point to compare\n * @return {boolean} True if a is below b, false otherwise\n */\nconst isBelow = (a, b) => a.y > b.y;\n\n/**\n * Check if point A is to the right of point B\n *\n * @param {Point} a An object containing the X and Y coordinates of the point\n * @param {Point} b Point to compare\n * @return {boolean} True if a is to the right of b, false otherwise\n */\nconst isRight = (a, b) => a.x > b.x;\n\n/**\n * Get blocked exit directions for current node\n *\n * @param {HTMLElement} container Current focus container\n * @param {HTMLElement} candidateContainer Candidate focus container\n * @return {string[]} Array of strings representing blocked directions\n */\nconst getBlockedExitDirs = (container, candidateContainer) => {\n  const currentAncestorContainers = collectContainers(container);\n  const candidateAncestorContainers = collectContainers(candidateContainer);\n\n  // Find common container for current container and candidate container and\n  // remove everything above it\n  for (let i = 0; i < candidateAncestorContainers.length; i++) {\n    let commonCandidate = candidateAncestorContainers[i];\n\n    const spliceIndex = currentAncestorContainers.indexOf(commonCandidate);\n\n    if (spliceIndex > -1) {\n      currentAncestorContainers.splice(spliceIndex);\n      break;\n    }\n  }\n\n  return currentAncestorContainers.reduce((acc, cur) => {\n    const dirs = (cur?.getAttribute('data-block-exit') || '').split(' ');\n\n    return acc.concat(dirs);\n  }, []);\n};\n\n/**\n * Check if the candidate is in the `exitDir` direction from the rect we're leaving,\n * with an overlap allowance of entryWeighting as a percentage of the candidate's width.\n *\n * @param {Object} entryRect An object representing the rectangle of the item we're moving to\n * @param {String} exitDir The direction we're moving in\n * @param {Object} exitPoint The midpoint of the edge we're leaving\n * @param {Float} entryWeighting Percentage of the candidate that is allowed to be behind the target\n * @return {Booelan} true if candidate is in the correct dir, false if not\n */\nconst isValidCandidate = (entryRect, exitDir, exitPoint, entryWeighting) => {\n  if (entryRect.width === 0 && entryRect.height === 0) return false;\n  if (!entryWeighting && entryWeighting != 0) entryWeighting = 0.3;\n\n  const weightedEntryPoint = {\n    x: entryRect.left + (entryRect.width * (exitDir === 'left' ? 1 - entryWeighting : exitDir === 'right' ? entryWeighting : 0.5)),\n    y: entryRect.top + (entryRect.height * (exitDir === 'up' ? 1 - entryWeighting : exitDir === 'down' ? entryWeighting : 0.5))\n  };\n\n  if (\n    exitDir === 'left' && isRight(exitPoint, weightedEntryPoint) ||\n    exitDir === 'right' && isRight(weightedEntryPoint, exitPoint) ||\n    exitDir === 'up' && isBelow(exitPoint, weightedEntryPoint) ||\n    exitDir === 'down' && isBelow(weightedEntryPoint, exitPoint)\n  ) return true;\n\n  return false;\n};\n\n/**\n * Sort the candidates ordered by distance to the elem,\n * and filter out invalid candidates.\n *\n * @param {HTMLElement[]} candidates A set of candidate elements to sort\n * @param {HTMLElement} elem The search origin\n * @param {string} exitDir The direction in which we exited the elem (left, right, up, down)\n * @return {HTMLElement[]} The valid candidates, in order by distance\n */\nconst sortValidCandidates = (candidates, elem, exitDir) => {\n  const exitRect = elem.getBoundingClientRect();\n  const exitPoint = getMidpointForEdge(exitRect, exitDir);\n  return candidates.filter(candidate => {\n    // Filter out candidates that are in the opposite direction or have no dimensions\n    const entryRect = candidate.getBoundingClientRect();\n    const allowedOverlap = parseFloat(candidate.getAttribute('data-lrud-overlap-threshold'));\n    return isValidCandidate(entryRect, exitDir, exitPoint, allowedOverlap);\n  }).map(candidate => {\n    const entryRect = candidate.getBoundingClientRect();\n    const nearestPoint = getNearestPoint(exitPoint, exitDir, entryRect);\n    const distance = getDistanceBetweenPoints(exitPoint, nearestPoint);\n    return {\n      candidate,\n      distance\n    };\n  }).sort((a, b) => a.distance - b.distance).map(({ candidate }) => candidate);\n};\n\n/**\n * Get the first parent container that matches the focusable candidate selector\n * @param {HTMLElement} startingCandidate The starting candidate to get the parent container of\n * @return {HTMLElement} The container that matches or null\n */\nconst getParentFocusableContainer = (startingCandidate) => {\n  if (!startingCandidate) return null;\n  do {\n    startingCandidate = getParentContainer(startingCandidate);\n  } while (startingCandidate && !matches(startingCandidate, focusableContainerSelector));\n\n  return startingCandidate;\n};\n\n/**\n * Get the next focus candidate\n *\n * @param {HTMLElement} elem The search origin\n * @param {string|number} keyOrKeyCode The key or keyCode value (from KeyboardEvent) of the pressed key\n * @param {HTMLElement} scope The element LRUD spatial is scoped to operate within\n * @return {HTMLElement} The element that should receive focus next\n */\nexport const getNextFocus = (elem, keyOrKeyCode, scope) => {\n  if (!scope || !scope.querySelector) scope = document.body;\n  if (!elem) return getFocusables(scope)?.[0];\n  const exitDir = _keyMap[keyOrKeyCode];\n\n  // Get parent focus container\n  const parentContainer = getParentContainer(elem);\n  if (parentContainer && matches(elem, focusableSelector)) {\n    parentContainer.setAttribute('data-focus', elem.id);\n    getParentFocusableContainer(elem)?.setAttribute('data-focus', elem.id);\n  }\n\n  let focusableCandidates = [];\n\n  // Get all siblings within a prioritised container\n  if (parentContainer?.getAttribute('data-lrud-prioritise-children') !== 'false' && scope.contains(parentContainer)) {\n    const focusableSiblings = getAllFocusables(parentContainer);\n    focusableCandidates = sortValidCandidates(focusableSiblings, elem, exitDir);\n  }\n\n  if (focusableCandidates.length === 0) {\n    const candidates = getAllFocusables(scope);\n    focusableCandidates = sortValidCandidates(candidates, elem, exitDir);\n  }\n\n  for (const candidate of focusableCandidates) {\n    const isBestCandidateAContainer = matches(candidate, containerSelector);\n    const candidateContainer = isBestCandidateAContainer ? candidate : getParentContainer(candidate);\n\n    const isCurrentContainer = candidateContainer === parentContainer;\n    const isNestedContainer = parentContainer?.contains(candidateContainer);\n    const isAnscestorContainer = candidateContainer?.contains(parentContainer);\n\n    if (!isCurrentContainer && (!isNestedContainer || isBestCandidateAContainer)) {\n      const blockedExitDirs = getBlockedExitDirs(parentContainer, candidateContainer);\n      if (blockedExitDirs.indexOf(exitDir) > -1) continue;\n\n      if (candidateContainer && !isAnscestorContainer) {\n        // Ignore active child behaviour when moving into a container that we\n        // are already nested in\n        const lastActiveChild = document.getElementById(candidateContainer?.getAttribute('data-focus'));\n\n        const newFocus = lastActiveChild || getFocusables(candidateContainer)?.[0];\n        getParentFocusableContainer(candidateContainer)?.setAttribute('data-focus', newFocus?.id);\n        candidateContainer?.setAttribute('data-focus', newFocus?.id);\n        return newFocus;\n      }\n    }\n\n    getParentFocusableContainer(candidateContainer)?.setAttribute('data-focus', candidate.id);\n    candidateContainer?.setAttribute('data-focus', candidate.id);\n    return candidate;\n  }\n};\n\nconst _left = 'left', _right = 'right', _up = 'up', _down = 'down';\nconst _keyMap = {\n  4: _left,\n  21: _left,\n  37: _left,\n  214: _left,\n  205: _left,\n  218: _left,\n  5: _right,\n  22: _right,\n  39: _right,\n  213: _right,\n  206: _right,\n  217: _right,\n  29460: _up,\n  19: _up,\n  38: _up,\n  211: _up,\n  203: _up,\n  215: _up,\n  29461: _down,\n  20: _down,\n  40: _down,\n  212: _down,\n  204: _down,\n  216: _down,\n  'ArrowLeft': _left,\n  'ArrowRight': _right,\n  'ArrowUp': _up,\n  'ArrowDown': _down\n};\n"],"mappings":"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"}